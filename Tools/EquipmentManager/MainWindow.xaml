<Window x:Class="EquipmentManager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Equipment Manager - Layout Editor Utility"
        Width="1200" Height="800"
        WindowStartupLocation="CenterScreen"
        Background="#F5F5F5">

    <Window.Resources>
        <Style x:Key="TabItemStyle" TargetType="TabItem">
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="FontSize" Value="12"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Menu Bar -->
        <Menu Grid.Row="0" Background="White" BorderBrush="#DEE2E6" BorderThickness="0,0,0,1">
            <MenuItem Header="_File">
                <MenuItem Header="_Open Layout..." Click="OpenLayout_Click" InputGestureText="Ctrl+O"/>
                <MenuItem Header="_Save Layout" Click="SaveLayout_Click" InputGestureText="Ctrl+S"/>
                <MenuItem Header="Save Layout _As..." Click="SaveLayoutAs_Click"/>
                <Separator/>
                <MenuItem Header="_Export">
                    <MenuItem Header="Export to CSV..." Click="ExportCSV_Click"/>
                    <MenuItem Header="Export to JSON..." Click="ExportJSON_Click"/>
                    <MenuItem Header="Export SQL Insert Statements..." Click="ExportSQL_Click"/>
                </MenuItem>
                <MenuItem Header="_Import">
                    <MenuItem Header="Import from CSV..." Click="ImportCSV_Click"/>
                </MenuItem>
                <Separator/>
                <MenuItem Header="E_xit" Click="Exit_Click"/>
            </MenuItem>
            <MenuItem Header="_Edit">
                <MenuItem Header="_Undo" Click="Undo_Click" InputGestureText="Ctrl+Z"/>
                <MenuItem Header="_Redo" Click="Redo_Click" InputGestureText="Ctrl+Y"/>
                <Separator/>
                <MenuItem Header="Add _New..." Click="AddNew_Click"/>
                <MenuItem Header="_Delete Selected" Click="DeleteSelected_Click" InputGestureText="Del"/>
                <MenuItem Header="_Duplicate Selected" Click="DuplicateSelected_Click" InputGestureText="Ctrl+D"/>
            </MenuItem>
            <MenuItem Header="_View">
                <MenuItem Header="Refresh" Click="Refresh_Click" InputGestureText="F5"/>
                <Separator/>
                <MenuItem Header="Show _Statistics" Click="ShowStatistics_Click"/>
            </MenuItem>
            <MenuItem Header="_Help">
                <MenuItem Header="_About" Click="About_Click"/>
            </MenuItem>
        </Menu>

        <!-- Toolbar -->
        <Border Grid.Row="1" Background="White" BorderBrush="#DEE2E6" BorderThickness="0,0,0,1" Padding="8,4">
            <StackPanel Orientation="Horizontal">
                <Button Style="{StaticResource ToolbarButton}" Click="OpenLayout_Click" ToolTip="Open Layout">
                    <TextBlock Text="Open" FontSize="12"/>
                </Button>
                <Button Style="{StaticResource ToolbarButton}" Click="SaveLayout_Click" ToolTip="Save Layout">
                    <TextBlock Text="Save" FontSize="12"/>
                </Button>
                <Separator Margin="8,4"/>
                <Button Style="{StaticResource ToolbarButton}" Click="AddNew_Click" ToolTip="Add New Item">
                    <TextBlock Text="+ Add" FontSize="12"/>
                </Button>
                <Button Style="{StaticResource ToolbarButton}" Click="DeleteSelected_Click" ToolTip="Delete Selected">
                    <TextBlock Text="Delete" FontSize="12"/>
                </Button>
                <Button Style="{StaticResource ToolbarButton}" Click="DuplicateSelected_Click" ToolTip="Duplicate Selected">
                    <TextBlock Text="Duplicate" FontSize="12"/>
                </Button>
                <Separator Margin="8,4"/>
                <TextBlock Text="Search:" VerticalAlignment="Center" Margin="8,0,4,0"/>
                <TextBox x:Name="SearchBox" Width="200" Height="26" Padding="4,2"
                         TextChanged="SearchBox_TextChanged" ToolTip="Search equipment by name"/>
                <Separator Margin="8,4"/>
                <TextBlock x:Name="FilePathLabel" Text="No file loaded" VerticalAlignment="Center"
                           Foreground="#666" FontSize="11"/>
            </StackPanel>
        </Border>

        <!-- Main Content - Tab Control with Data Grids -->
        <TabControl Grid.Row="2" Margin="8" x:Name="MainTabControl">

            <!-- EOT Cranes Tab -->
            <TabItem Header="EOT Cranes" Style="{StaticResource TabItemStyle}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Style="{StaticResource HeaderStyle}" Margin="8">
                        <Run Text="EOT Cranes"/>
                        <Run x:Name="EOTCraneCount" Text="(0)" Foreground="#666"/>
                    </TextBlock>
                    <DataGrid x:Name="EOTCraneGrid" Grid.Row="1" Style="{StaticResource DataGridStyle}"
                              SelectionChanged="DataGrid_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="150"/>
                            <DataGridTextColumn Header="Bay Width" Binding="{Binding BayWidth, StringFormat=F1}" Width="80"/>
                            <DataGridTextColumn Header="Reach Left" Binding="{Binding ReachLeft, StringFormat=F1}" Width="80"/>
                            <DataGridTextColumn Header="Reach Right" Binding="{Binding ReachRight, StringFormat=F1}" Width="80"/>
                            <DataGridTextColumn Header="Zone Min" Binding="{Binding ZoneMin, StringFormat=F2}" Width="70"/>
                            <DataGridTextColumn Header="Zone Max" Binding="{Binding ZoneMax, StringFormat=F2}" Width="70"/>
                            <DataGridTextColumn Header="Bridge Speed" Binding="{Binding SpeedBridge, StringFormat=F2}" Width="90"/>
                            <DataGridTextColumn Header="Trolley Speed" Binding="{Binding SpeedTrolley, StringFormat=F2}" Width="90"/>
                            <DataGridTextColumn Header="Hoist Speed" Binding="{Binding SpeedHoist, StringFormat=F2}" Width="80"/>
                            <DataGridTextColumn Header="Color" Binding="{Binding Color}" Width="80"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Jib Cranes Tab -->
            <TabItem Header="Jib Cranes" Style="{StaticResource TabItemStyle}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Style="{StaticResource HeaderStyle}" Margin="8">
                        <Run Text="Jib Cranes"/>
                        <Run x:Name="JibCraneCount" Text="(0)" Foreground="#666"/>
                    </TextBlock>
                    <DataGrid x:Name="JibCraneGrid" Grid.Row="1" Style="{StaticResource DataGridStyle}"
                              SelectionChanged="DataGrid_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="150"/>
                            <DataGridTextColumn Header="Center X" Binding="{Binding CenterX, StringFormat=F1}" Width="80"/>
                            <DataGridTextColumn Header="Center Y" Binding="{Binding CenterY, StringFormat=F1}" Width="80"/>
                            <DataGridTextColumn Header="Radius" Binding="{Binding Radius, StringFormat=F1}" Width="80"/>
                            <DataGridTextColumn Header="Arc Start" Binding="{Binding ArcStart}" Width="70"/>
                            <DataGridTextColumn Header="Arc End" Binding="{Binding ArcEnd}" Width="70"/>
                            <DataGridTextColumn Header="Slew Speed" Binding="{Binding SpeedSlew, StringFormat=F1}" Width="90"/>
                            <DataGridTextColumn Header="Color" Binding="{Binding Color}" Width="80"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Zones Tab -->
            <TabItem Header="Zones" Style="{StaticResource TabItemStyle}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Style="{StaticResource HeaderStyle}" Margin="8">
                        <Run Text="Zones"/>
                        <Run x:Name="ZoneCount" Text="(0)" Foreground="#666"/>
                    </TextBlock>
                    <DataGrid x:Name="ZoneGrid" Grid.Row="1" Style="{StaticResource DataGridStyle}"
                              SelectionChanged="DataGrid_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="150"/>
                            <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="100"/>
                            <DataGridTextColumn Header="X" Binding="{Binding X, StringFormat=F1}" Width="70"/>
                            <DataGridTextColumn Header="Y" Binding="{Binding Y, StringFormat=F1}" Width="70"/>
                            <DataGridTextColumn Header="Width" Binding="{Binding Width, StringFormat=F1}" Width="70"/>
                            <DataGridTextColumn Header="Height" Binding="{Binding Height, StringFormat=F1}" Width="70"/>
                            <DataGridTextColumn Header="Capacity" Binding="{Binding Capacity}" Width="70"/>
                            <DataGridTextColumn Header="Max Occupancy" Binding="{Binding MaxOccupancy}" Width="100"/>
                            <DataGridCheckBoxColumn Header="Restricted" Binding="{Binding IsRestricted}" Width="70"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- AGV Stations Tab -->
            <TabItem Header="AGV Stations" Style="{StaticResource TabItemStyle}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Style="{StaticResource HeaderStyle}" Margin="8">
                        <Run Text="AGV Stations"/>
                        <Run x:Name="AGVStationCount" Text="(0)" Foreground="#666"/>
                    </TextBlock>
                    <DataGrid x:Name="AGVStationGrid" Grid.Row="1" Style="{StaticResource DataGridStyle}"
                              SelectionChanged="DataGrid_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="150"/>
                            <DataGridTextColumn Header="Type" Binding="{Binding StationType}" Width="100"/>
                            <DataGridTextColumn Header="X" Binding="{Binding X, StringFormat=F1}" Width="70"/>
                            <DataGridTextColumn Header="Y" Binding="{Binding Y, StringFormat=F1}" Width="70"/>
                            <DataGridTextColumn Header="Rotation" Binding="{Binding Rotation, StringFormat=F1}" Width="70"/>
                            <DataGridTextColumn Header="Service Time" Binding="{Binding ServiceTime, StringFormat=F1}" Width="90"/>
                            <DataGridTextColumn Header="Dwell Time" Binding="{Binding DwellTime, StringFormat=F1}" Width="80"/>
                            <DataGridTextColumn Header="Queue Cap" Binding="{Binding QueueCapacity}" Width="70"/>
                            <DataGridCheckBoxColumn Header="Is Homing" Binding="{Binding IsHoming}" Width="70"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Conveyors Tab -->
            <TabItem Header="Conveyors" Style="{StaticResource TabItemStyle}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Style="{StaticResource HeaderStyle}" Margin="8">
                        <Run Text="Conveyors"/>
                        <Run x:Name="ConveyorCount" Text="(0)" Foreground="#666"/>
                    </TextBlock>
                    <DataGrid x:Name="ConveyorGrid" Grid.Row="1" Style="{StaticResource DataGridStyle}"
                              SelectionChanged="DataGrid_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="150"/>
                            <DataGridTextColumn Header="Type" Binding="{Binding ConveyorType}" Width="100"/>
                            <DataGridTextColumn Header="Direction" Binding="{Binding Direction}" Width="100"/>
                            <DataGridTextColumn Header="Width" Binding="{Binding Width, StringFormat=F1}" Width="70"/>
                            <DataGridTextColumn Header="Speed" Binding="{Binding Speed, StringFormat=F2}" Width="70"/>
                            <DataGridCheckBoxColumn Header="Accumulating" Binding="{Binding IsAccumulating}" Width="90"/>
                            <DataGridTextColumn Header="Color" Binding="{Binding Color}" Width="80"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Openings Tab -->
            <TabItem Header="Openings" Style="{StaticResource TabItemStyle}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Style="{StaticResource HeaderStyle}" Margin="8">
                        <Run Text="Openings"/>
                        <Run x:Name="OpeningCount" Text="(0)" Foreground="#666"/>
                    </TextBlock>
                    <DataGrid x:Name="OpeningGrid" Grid.Row="1" Style="{StaticResource DataGridStyle}"
                              SelectionChanged="DataGrid_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="150"/>
                            <DataGridTextColumn Header="Type" Binding="{Binding OpeningType}" Width="100"/>
                            <DataGridTextColumn Header="State" Binding="{Binding State}" Width="80"/>
                            <DataGridTextColumn Header="X" Binding="{Binding X, StringFormat=F1}" Width="70"/>
                            <DataGridTextColumn Header="Y" Binding="{Binding Y, StringFormat=F1}" Width="70"/>
                            <DataGridTextColumn Header="Clear Width" Binding="{Binding ClearWidth, StringFormat=F1}" Width="80"/>
                            <DataGridTextColumn Header="Clear Height" Binding="{Binding ClearHeight, StringFormat=F1}" Width="85"/>
                            <DataGridTextColumn Header="Capacity" Binding="{Binding Capacity}" Width="70"/>
                            <DataGridTextColumn Header="Direction" Binding="{Binding DirectionMode}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Nodes Tab -->
            <TabItem Header="Nodes" Style="{StaticResource TabItemStyle}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Style="{StaticResource HeaderStyle}" Margin="8">
                        <Run Text="Nodes"/>
                        <Run x:Name="NodeCount" Text="(0)" Foreground="#666"/>
                    </TextBlock>
                    <DataGrid x:Name="NodeGrid" Grid.Row="1" Style="{StaticResource DataGridStyle}"
                              SelectionChanged="DataGrid_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="150"/>
                            <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="100"/>
                            <DataGridTextColumn Header="X" Binding="{Binding Visual.X, StringFormat=F1}" Width="70"/>
                            <DataGridTextColumn Header="Y" Binding="{Binding Visual.Y, StringFormat=F1}" Width="70"/>
                            <DataGridTextColumn Header="Width" Binding="{Binding Visual.Width, StringFormat=F1}" Width="70"/>
                            <DataGridTextColumn Header="Height" Binding="{Binding Visual.Height, StringFormat=F1}" Width="70"/>
                            <DataGridTextColumn Header="Servers" Binding="{Binding Simulation.Servers}" Width="60"/>
                            <DataGridTextColumn Header="Capacity" Binding="{Binding Simulation.Capacity}" Width="70"/>
                            <DataGridTextColumn Header="Process Time" Binding="{Binding Simulation.ProcessTime}" Width="90"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Runways Tab -->
            <TabItem Header="Runways" Style="{StaticResource TabItemStyle}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Style="{StaticResource HeaderStyle}" Margin="8">
                        <Run Text="Runways"/>
                        <Run x:Name="RunwayCount" Text="(0)" Foreground="#666"/>
                    </TextBlock>
                    <DataGrid x:Name="RunwayGrid" Grid.Row="1" Style="{StaticResource DataGridStyle}"
                              SelectionChanged="DataGrid_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="150"/>
                            <DataGridTextColumn Header="Start X" Binding="{Binding StartX, StringFormat=F1}" Width="70"/>
                            <DataGridTextColumn Header="Start Y" Binding="{Binding StartY, StringFormat=F1}" Width="70"/>
                            <DataGridTextColumn Header="End X" Binding="{Binding EndX, StringFormat=F1}" Width="70"/>
                            <DataGridTextColumn Header="End Y" Binding="{Binding EndY, StringFormat=F1}" Width="70"/>
                            <DataGridTextColumn Header="Height" Binding="{Binding Height, StringFormat=F1}" Width="70"/>
                            <DataGridTextColumn Header="Capacity" Binding="{Binding Capacity, StringFormat=F0}" Width="80"/>
                            <DataGridTextColumn Header="Color" Binding="{Binding Color}" Width="80"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

        </TabControl>

        <!-- Status Bar -->
        <StatusBar Grid.Row="3" Background="White" BorderBrush="#DEE2E6" BorderThickness="0,1,0,0">
            <StatusBarItem>
                <TextBlock x:Name="StatusText" Text="Ready - Open a layout file to begin"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock x:Name="SelectionStatus" Text=""/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock x:Name="TotalItemsLabel" Text="Total: 0 items"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
